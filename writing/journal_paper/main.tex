% \documentclass[ba,preprint]{imsart}% use this for supplement article
\documentclass[ba]{imsart}
%
\pubyear{2021}
\volume{TBA}
\issue{TBA}
% \doi{0000}
%\arxiv{}
\firstpage{1}
\lastpage{1}

\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{natbib}
\usepackage[colorlinks,citecolor=blue,urlcolor=blue,filecolor=blue,backref=page]{hyperref}
\usepackage{graphicx}


% my added packages: copied from the swiss IJ paper
\usepackage{microtype}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{booktabs} % for professional tables
\usepackage{siunitx}
\usepackage{hyperref}
\usepackage{xargs}[2008/03/08]
\usepackage{xfrac}

% adding line numbers.
% comment this out when done
% adding line numbers also somewhat messes up the
% formatting on the first page; it looks fine
% without line numbers, curiously.

% \usepackage{lineno}
% \linenumbers

% For inline enumerate:
% https://en.wikibooks.org/wiki/LaTeX/List_Structures
\usepackage{blindtext}
\usepackage[inline]{enumitem}

% Documentation
% http://ftp.math.purdue.edu/mirrors/ctan.org/macros/latex/contrib/refstyle/refstyle.pdf
\usepackage{refstyle}
\usepackage{varioref} % Use refstyle instead of varioref directly.

\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{mathtools}
\usepackage{colonequals}
\usepackage{algpseudocode, algorithm} %typical alg typesetting packages
\usepackage{xargs} % For def with default arguments

% Math scripts
\usepackage{mathrsfs}  % For script fonts
%\usepackage{dutchcal} % Lower-case mathcal
%\usepackage{mathbbol}  % For lower-case bold fonts

% \DeclareFontFamily{OT1}{pzc}{}
% \DeclareFontShape{OT1}{pzc}{m}{it}{<-> s * [1.10] pzcmi7t}{}
% \DeclareMathAlphabet{\mathpzc}{OT1}{pzc}{m}{it}

\usepackage{listings}
\usepackage{pdfpages}

% added packages for todo notes
% pass in option ``disable" to remove notes
\usepackage[textsize=tiny]{todonotes}

% This picks up the knitr boilerplate, allowing us to \input partial knitr
% documents.
\input{_knitr_header.tex}

\startlocaldefs
% This defines math macros.
\input{_math_defs.tex}

% This specifies the formatting for references (sections, theorems, etc.)
\input{_reference_defs.tex}
\endlocaldefs

\begin{document}

% Output of the knitr file defining certain simulated figures.
\input{simulation_examples.tex}

%% *** Frontmatter ***

\begin{frontmatter}
\title{Evaluating Sensitivity to the Stick Breaking Prior in Bayesian Nonparametrics}
%\title{\support{}}
\runtitle{BNP sensitivity}

\begin{aug}
\author{\fnms{Ryan} \snm{Giordano}\thanksref{addr1,t1}},
\author{\fnms{Runjing} \snm{Liu}\thanksref{addr2,t1}},
\author{\fnms{Michael I.} \snm{Jordan}\thanksref{addr2}},
\and
\author{\fnms{Tamara} \snm{Broderick}\thanksref{addr1}}
%\author{\fnms{<firstname>} \snm{<surname>}\thanksref{}\ead[label=e1]{}}
%\and
%\author{\fnms{} \snm{}}

\runauthor{}

\address[addr1]{Department of EECS, MIT
77 Massachusetts Ave., 38-401
Cambridge, MA 02139}

\address[addr2]{Department of Statistics, UC Berkeley
367 Evans Hall, UC Berkeley
Berkeley, CA 94720}

\thankstext{t1}{Equal contribution. }

\end{aug}

\begin{abstract}
\input{abstract}
\end{abstract}

%% ** Keywords **
\begin{keyword}%[class=MSC]
\kwd{Dirichlet Process}
\kwd{Stick breaking}
\kwd{Local robustness}
\kwd{Variational Bayes}
\kwd{Fr{\'e}chet differentiability}
\kwd{fastSTRUCTURE}
%\kwd[]{}
\end{keyword}

\end{frontmatter}

%% ** Mainmatter **

\section{Introduction}\seclabel{introduction}
\input{introduction.tex}


\section{The model and variational approximation}
\seclabel{model}
    \subsection{A stick-breaking model for clustering}
    \seclabel{model_bnp}
    \input{model_bnp.tex}

    \subsection{Variational approximation}
    \seclabel{model_vb}
    \input{model_vb.tex}

    % \subsection{Robustness and the Taylor series approximation}
    % \seclabel{model_taylor}
    % \input{model_space_of_priors.tex}

\section{A local approximation for sensitivity}
\seclabel{local_sensitivity}
\input{local_sensitivity}

\section{The influence function and worst-case functional perturbations}
\seclabel{influence_function}
\input{influence_function}

\section{Fast computation of the sensitivity}
\seclabel{computing_sensitivity}
\input{computing_sensitivity.tex}

\section{Experimental Results}
\seclabel{results}
\input{experiments_intro.tex}

    \subsection{Gaussian mixture modeling on iris data}
    \seclabel{results_iris}
    \input{experiments_iris.tex}

    \subsection{Regression mixture modeling}
    \seclabel{results_mice}
    \input{experiments_mice.tex}

    \subsection{Genetic admixture modeling with fastSTRUCTURE}
    \seclabel{results_structure}
    \input{experiments_structure.tex}

    \subsection{Computation time}
    \seclabel{compute_time}
    \input{timing_table.tex}

% BA does not require a conclusion.
% https://projecteuclid.org/journals/bayesian-analysis/author-guidelines
% \section{Conclusion}
% \seclabel{conclusion}
% TODO: write this when the rest of the paper is done.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Supplementary Material, if any, should   %%
%% be provided in {supplement} environment  %%
%% with title and short description.        %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{supplement}
%\stitle{???}
%\sdescription{???.}
%\end{supplement}

% ** The bibliograhy **
\bibliographystyle{ba}
\bibliography{references}% place <bib-data-file> in ./bib folder

% ** Acknowledgements **
\begin{acks}[Acknowledgments]
  TODO
\end{acks}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% from my understanding,
%% BA requests that supplementary material should be in a new file.
%% For now, I left it here so all our text is in one place,
%% and will move it later
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\appendix

% \section{Illustrative examples and review}
% \seclabel{examples}
% \input{examples}

\section{General differentiability results}
\applabel{diffable_intro}
\input{diffable_intro}

    \subsection{Parametric prior perturbations}
    \applabel{diffable_parametric}
    \input{diffable_parametric}

    \subsection{Differentiability of BNP models with respect to $\alpha$}
    \applabel{diffable_concentration}
    \input{diffable_concentration}

    \subsection{Nonparametric prior perturbations}
    \applabel{diffable_nonparametric}
    \input{diffable_nonparametric}

    \subsection{Worst-case prior perturbations and Fr{\'e}chet differentiability}
    \applabel{diffable_worst_case}
    \input{diffable_worst_case}

    \subsection{Other nonparametric prior perturbations}
    \applabel{diffable_lp}
    \input{diffable_lp}

\section{Proofs}\applabel{proofs}
\input{app_proofs.tex}

\section{Positive Perturbations Are Counterintuitive}\applabel{positive_pert}
\input{app_positive_perturbations.tex}

\section{Computational details}

\subsection{The optimal local parameters}
\applabel{gmm_global_local_vb}
\input{app_global_local}

\subsection{More details on computing and inverting the Hessian}
\applabel{more_hessian}
\input{app_hess_inversion}

\subsection{Expressing $\g$ using global parameters only}
\applabel{vb_insample_nclusters_example}
\input{app_global_local_g}

\subsection{Evaluating stick expectations}\applabel{gh_quadrature}
\input{app_gh}

\subsection{Unconstrained variational parameterizations}
\applabel{app_vb_unconstrained}
\input{app_vb_unconstrained.tex}

\section{Additional experiment details}
\applabel{app_results}

First, we review the Beta prior on the stick-breaking proportions,
which are common to each model we considered.
Then, we give some additional modeling details for each experiment.

    \subsection{The Beta prior}
    \applabel{app_beta_prior}
    \input{app_beta_prior}

    \subsection{Gaussian mixture modeling on iris data}
    \applabel{app_iris}
    \input{app_iris.tex}

    \subsection{Regression mixture modeling}
    \applabel{app_mice}
    \input{app_mice.tex}

    \subsection{fastSTRUCTURE}
    \applabel{app_structure}
    \input{app_structure}


\section{fastSTRUCTURE supplemental results}\applabel{app_structure_results}
\input{app_structure_results}




\end{document}
